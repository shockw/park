# jeemanage-park
## 人脸设备
序列号：84E0F420741100B0
密码：88888888
序列号84E0F420A32800B0
开放平台的用户名密码：18056067506/ustcinfo123

## 停车管理系统
停车订单信息：主键，停车架，停车楼层，用户ID，存车时间，取车时间，付款时间，存车照片，取车照片，订单状态，已付款项。
订单状态：0:已注册，1:已存车、2:正在取车，3:待付款、4:已付款。
存车、取车、订单的状态监控

## 人脸识别QQ：754954012## 支付渠道
用户出示付款码，对准商户扫码枪，商户完成扫码，提交微信支付平台完成支付，接口同步返回响应结果。
所需材料：
       通过个体工商户或企业主体申请微信商户，个体工商户材料包括营业执照照片、注册号、商户名称、注册地址、经营者姓名/法定代表人、营业期限、法人身份证正反面、证件号码、法人账户等。
      企业商户材料包括营业执照照片、注册号、商户名称、注册地址、经营者姓名/法定代表人、营业期限、法人身份证正反面、证件号码、对公账户等。
商户扫码枪：https://item.jd.com/7355997.html#none

## 20190411工作总结
扫码器试了下很好用，可以直接将二维码输入到电脑上的表单里，并自动回车。
商户已经成功申请，但实际调用中仍然需要绑定公共号或小程序或app，这块我又注册了一个服务号，看了接入指南，这块服务需要完成微信认证，这块可能需要收费年费300。

## 20190505
与车库接口梳理
1）申请停车，占用车位：查询是否有空闲车位，如果有车位，则占用车位，并将车架落到此车位上，成功或失败返回一定标识。
2）取车入门：车子所在层落到地面，完成。
实际使用时只需要这两个接口， 这块目前看不知能否有此两个接口。

## 20190511
重新整理停车管理应用代码。
系统管理员 shockw/admin
1、增加车库管理员 admin/admin，只看到停车管理菜单。---配置完成
2、增加已经缴费列表和未缴费列表，缴费列表从微信获取。支持未缴费列表人工缴费。---已完成
3、增加人工开门。---已完成
4、绑定微信，建议使用运营者的执照信息。
5、问题：无法锁定让人不进去。因为不知道人什么时候出来，另外不知道车架是怎么控制的，如果是由用户自行控制的，就基本不需要软件来锁定，随便进入，通过人脸来计费即可。如果需要指令来控制其转动，就不太好控制。---需要对照实际车架进行调研
6、支付完成后需要查询是否完成支付。---未完成，目前只是直接支付。有异常的话不能及时控制。

## 20190614
系统与车架接口确定。系统来管理每一层的闲忙车位数，发送平台层数给车架，车架落下此层。并且直到车架落好后，再返回响应给系统，这样可以避免多人同时操作车架。

## 20190714 
整个流程测试
1、操作车架接口测试
1、系统运营功能：出入口门禁数据一键配置，门禁数据清理、车架数据清理 
      一键系统初始化。删除订单数据、车架复位、门禁数据删除。出入口门禁配置导入设置
2、功能异常完善
      1）需要判断存车有没有停好。
      2）存车没有存好后不能取车。
      3）系统全部是单线程操作。需要有一个信号来控制放不放人进去。
      4）同一人不能注册两次。二次比对
      5）与车架连接的时候会锁住
存车中：生成一条存车中的订单，人脸录入、订单比对不重复人脸。 门禁打开，落车架，令牌false。
已存车：令牌true。
取车中：门禁打开。令牌设置为false，落车架。
已取车：令牌为true。
待付款：
已付款：

超过一定分钟认为前面一个人已经存完车，并且没有障碍物。
一次有，一次没有。两种条件满足之一。
等落架是了安全。